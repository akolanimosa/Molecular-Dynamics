# Define initial parameters.
units metal
atom_style charge
boundary p p p

# Define neighbor list options.
neighbor 2.0 bin
neigh_modify every 1 delay 0 check yes

# Lattice constant.
variable a equal 3.612424

# Number of cell units along the directions.
variable Nx equal 5.0
variable Ny equal 5.0
variable Nz equal 5.0
variable Nz_2 equal ${Nz}*2

# Create simulation box.
lattice fcc ${a}
region whole block 0 ${Nx} 0 ${Ny} 0 ${Nz_2}
create_box 3 whole

# Create bulk atoms.
region atom_region block 0 ${Nx} 0 ${Ny} 0 ${Nz}
create_atoms 1 region atom_region

# Create CH4 molecule.
molecule ch4 CH4.mol
create_atoms 1 single 2.5 2.5 5.5 mol ch4 12345

# Define bulk and surface atoms and fix bulk atom positions.
variable bulk_atoms atom (z<4*${a})
group bulk variable bulk_atoms
group surface subtract all bulk
fix 1 bulk setforce 0 0 0

# Define dt.
timestep 0.0001

# Define damping parameter.
variable damp equal $(400*dt)

# Set interatomic potentials.
pair_style reax/c NULL safezone 1.6 mincap 100
pair_coeff * * ffield.reax Ni C H 
fix 2 all qeq/reax 100 0 10 1e-6 reax/c

# Define atomic masses.
mass 1 58.6934
mass 2 12.011
mass 3 1.00784

# Define OVITO readable dump.
dump 1 all custom 10 CH4onNi_single.lammpstrj id type xu yu zu
dump_modify 1 sort id

# Set output step and values.
thermo 100
thermo_style custom step temp etotal pe ke

# Give initial velocity to surface atoms.
velocity surface create 50 12345 rot yes dist gaussian

# Relax the system. 
fix 3 all nvt temp 50 500 ${damp}
run 10000

unfix 3

fix 4 all nvt temp 500 500 ${damp}
run 10000
